<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Notas Satohaki Pro</title>
  <style>
    body {
      background: #f5f6fa;
      font-family: Arial, sans-serif;
      color: #333;
      max-width: 800px;
      margin: 40px auto;
      padding: 0 20px;
      line-height: 1.5;
    }
    h1, h2 {
      color: #6C5CE7;
      margin-bottom: 12px;
    }
    .section {
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 12px rgba(0,0,0,0.1);
      margin-bottom: 30px;
      padding: 20px;
    }
    .note {
      width: 100%;
      min-height: 150px;
      border: 1px solid #ccc;
      border-radius: 6px;
      padding: 12px;
      background: #fafbfc;
      white-space: pre-wrap;
      overflow-y: auto;
      outline: none;
    }
    .note[contenteditable="true"] {
      box-shadow: inset 0 0 4px #6C5CE7aa;
      background: #fff;
    }
    .buttons {
      margin-top: 10px;
    }
    button {
      background: #6C5CE7;
      color: white;
      border: none;
      border-radius: 5px;
      padding: 8px 14px;
      margin-right: 8px;
      cursor: pointer;
      font-weight: bold;
      transition: opacity 0.2s;
    }
    button:hover {
      opacity: 0.9;
    }
    button.copy {
      background: #00B894;
    }
    #readme {
      font-family: monospace;
      background: #eef1f5;
      padding: 15px;
      border-radius: 6px;
      white-space: pre-wrap;
      max-height: 400px;
      overflow-y: auto;
      border: 1px solid #6C5CE7;
    }
    /* Modal */
    #modal {
      display: none;
      position: fixed;
      top:0; left:0; right:0; bottom:0;
      background: rgba(0,0,0,0.5);
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }
    #modal.active { display: flex; }
    #modal .box {
      background: white;
      padding: 20px;
      border-radius: 6px;
      width: 300px;
      text-align: center;
      box-shadow: 0 4px 20px rgba(0,0,0,0.2);
    }
    #modal input {
      width: calc(100% - 20px);
      padding: 8px;
      margin-bottom: 12px;
      border-radius: 4px;
      border: 1px solid #ccc;
    }
  </style>
</head>
<body>

  <h1>Notas Satohaki Pro</h1>

  <div class="section">
    <h2>Nota Principal</h2>
    <div id="note-main" class="note" contenteditable="false" spellcheck="false"></div>
    <div class="buttons">
      <button id="btn-edit-main">Editar</button>
      <button id="btn-copy-main" class="copy">Copiar</button>
    </div>
  </div>

  <div class="section">
    <h2>Instrucciones para ChatGPT</h2>
    <div id="note-instr" class="note" contenteditable="false" spellcheck="false"></div>
    <div class="buttons">
      <button id="btn-edit-instr">Editar</button>
      <button id="btn-copy-instr" class="copy">Copiar</button>
    </div>
  </div>

  <div class="section">
    <h2>README (Contenido combinado)</h2>
    <pre id="readme"></pre>
  </div>

  <!-- Modal de contrase単a -->
  <div id="modal">
    <div class="box">
      <p><strong>Contrase単a para editar:</strong></p>
      <input type="password" id="pass-input" placeholder="Ingrese contrase単a" />
      <div>
        <button id="modal-cancel" class="copy">Cancelar</button>
        <button id="modal-ok">OK</button>
      </div>
    </div>
  </div>

  <script>
  (function(){
    const PASS = 'lightsato';

    const noteMain   = document.getElementById('note-main');
    const noteInstr  = document.getElementById('note-instr');
    const readme     = document.getElementById('readme');
    const btnEditM   = document.getElementById('btn-edit-main');
    const btnEditI   = document.getElementById('btn-edit-instr');
    const btnCopyM   = document.getElementById('btn-copy-main');
    const btnCopyI   = document.getElementById('btn-copy-instr');
    const modal      = document.getElementById('modal');
    const passInput  = document.getElementById('pass-input');
    const modalOk    = document.getElementById('modal-ok');
    const modalCancel= document.getElementById('modal-cancel');

    let currentNote = null;

    function load() {
      noteMain.innerHTML  = localStorage.getItem('satohaki_main') || '';
      noteInstr.innerHTML = localStorage.getItem('satohaki_instr') || '';
      updateReadme();
    }

    function saveAndUpdate() {
      localStorage.setItem('satohaki_main',  noteMain.innerHTML);
      localStorage.setItem('satohaki_instr', noteInstr.innerHTML);
      updateReadme();
    }

    function updateReadme() {
      const a = noteMain.innerText.trim();
      const b = noteInstr.innerText.trim();
      readme.textContent = `[Nota Principal]\n${a}\n\n[Instrucciones para ChatGPT]\n${b}`;
    }

    function showModal(noteDiv) {
      currentNote = noteDiv;
      passInput.value = '';
      modal.classList.add('active');
      passInput.focus();
    }

    function hideModal() {
      modal.classList.remove('active');
      currentNote = null;
    }

    modalOk.addEventListener('click', ()=>{
      if (passInput.value === PASS && currentNote) {
        currentNote.contentEditable = true;
        currentNote.focus();
        if (currentNote === noteMain)  btnEditM.textContent = 'Guardar';
        else                            btnEditI.textContent = 'Guardar';
        hideModal();
      } else {
        alert('Contrase単a incorrecta');
        passInput.value = '';
        passInput.focus();
      }
    });
    modalCancel.addEventListener('click', hideModal);
    passInput.addEventListener('keydown', e=>{
      if (e.key === 'Enter') modalOk.click();
    });

    btnEditM.addEventListener('click', ()=>{
      if (btnEditM.textContent === 'Editar') showModal(noteMain);
      else {
        noteMain.contentEditable = false;
        btnEditM.textContent = 'Editar';
        saveAndUpdate();
      }
    });

    btnEditI.addEventListener('click', ()=>{
      if (btnEditI.textContent === 'Editar') showModal(noteInstr);
      else {
        noteInstr.contentEditable = false;
        btnEditI.textContent = 'Editar';
        saveAndUpdate();
      }
    });

    btnCopyM.addEventListener('click', ()=>{
      navigator.clipboard.writeText(noteMain.innerText)
        .then(_=> alert('Nota Principal copiada'));
    });
    btnCopyI.addEventListener('click', ()=>{
      navigator.clipboard.writeText(noteInstr.innerText)
        .then(_=> alert('Instrucciones copiadas'));
    });

    noteMain.addEventListener('input', saveAndUpdate);
    noteInstr.addEventListener('input', saveAndUpdate);

    load();
  })();
  </script>

</body>
</html>
